<!doctype html>
<html lang="zxx">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>LunaLoom</title>

  <link rel="icon" href="/img/favicon.png">
  <link rel="stylesheet" href="/css/bootstrap.min.css">

  <link rel="stylesheet" href="/css/animate.css">
  <link rel="stylesheet" href="/css/owl.carousel.min.css">
  <link rel="stylesheet" href="/css/all.css">
  <link rel="stylesheet" href="/css/flaticon.css">
  <link rel="stylesheet" href="/css/themify-icons.css">
  <link rel="stylesheet" href="/css/magnific-popup.css">
  <link rel="stylesheet" href="/css/slick.css">

  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/header.css">
   <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/product_list.css">
</head>

<body>

  <%- include('../partials/header') %>

  <% if (success) { %>
    <div class="alert alert-success text-center"><%= success %></div>
  <% } %>

  <% if (error) { %>
    <div class="alert alert-danger text-center"><%= error %></div>
  <% } %>

  <section class="breadcrumb_part">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="breadcrumb_iner">
            <h2>Product List</h2>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="product_list section_padding">
    <div class="container">
      <div class="row">

        <!-- Sidebar -->
        <div class="col-md-4">
          <div class="product_sidebar">

            <!-- Category Filter -->
            <div class="single_sedebar">
              <div class="select_option">
                <div class="select_option_list">
                  Category <i class="right fas fa-caret-down"></i>
                </div>

                <div class="select_option_dropdown">
                  <p><a href="/product_list">All</a></p>
                  <p><a href="/product_list?category=Bedding">Bedding</a></p>
                  <p><a href="/product_list?category=Pillows%20%26%20Cushions">Pillows & Cushions</a></p>
                </div>
              </div>
            </div>

            <!-- Brand Filter -->
            <div class="single_sedebar">
              <div class="select_option">
                <div class="select_option_list">
                  Brand <i class="right fas fa-caret-down"></i>
                </div>

                <div class="select_option_dropdown">
                  <p><a href="/product_list">All</a></p>
                  <p><a href="/product_list?brand=Welspun%20Living">Welspun Living</a></p>
                  <p><a href="/product_list?brand=Sleepwell">Sleepwell</a></p>
                  <p><a href="/product_list?brand=Zara%20Home">Zara Home</a></p>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Product Grid -->
        <div class="col-md-8">
          <div class="product_list">
            <div class="row">

              <% if (products && products.length > 0) { %>

                <% products.forEach(product => { %>
                  <div class="col-lg-6 col-sm-6">
                    <div class="single_product_item">

                      <div class="product-image-wrapper">
                        <a href="/wishlist/add/<%= product._id %>" class="wishlist-icon">
                          <i class="far fa-heart"></i>
                        </a>

                        <!-- FIXED FALLBACK IMAGE -->
                        <img 
                          src="<%= product.images?.length ? product.images[0] : '/img/default-product.png' %>" 
                          class="img-fluid product-img">
                      </div>

                      <h3>
                        <a href="/product/<%= product._id %>"><%= product.name %></a>
                      </h3>

                      <p>From â‚¹<%= product.price %></p>

                      <div class="product-buttons">
                        <a href="/cart/add/<%= product._id %>" class="btn btn-sm btn-primary">Add to Cart</a>
                      </div>

                    </div>
                  </div>
                <% }) %>

              <% } else { %>
                <p class="text-center w-100">No products found</p>
              <% } %>

            </div>

            <div class="load_more_btn text-center">
              <a href="#" class="btn_3">Load More</a>
            </div>

          </div>
        </div>

      </div>
    </div>
  </section>

  <%- include('../partials/footer') %>

</body>
</html>
