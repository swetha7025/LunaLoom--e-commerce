<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Profile</title>

    <!-- REQUIRED CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/all.css">              <!-- FontAwesome -->
    <link rel="stylesheet" href="/css/themify-icons.css">     <!-- Search icon -->
    <link rel="stylesheet" href="/css/flaticon.css">          <!-- Cart icon -->
    
    <!-- Your Styles -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/profile.css">
</head>

<body>

<%- include('../partials/header') %>

<div class="container mt-5">
    <h3>Edit Profile</h3>

    <% if (success) { %>
        <div class="alert alert-success"><%= success %></div>
    <% } %>

    <% if (error) { %>
        <div class="alert alert-danger"><%= error %></div>
    <% } %>

    <div class="profile-photo-container">

        <% if (user && user.profileImage) { %>

            <div class="profile-photo-wrapper">
                <img 
                    src="<%= user.profileImage %>" 
                    class="profile-photo"
                    alt="Profile Image"
                >

                <!-- delete icon -->
                <form action="/removeProfileImage" method="POST">
                    <button class="remove-icon-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </form>
            </div>

        <% } else { %>

            <div class="profile-initial">
                <%= user && user.name ? user.name.charAt(0).toUpperCase() : "U" %>
            </div>

        <% } %>

        <!-- Upload button -->
        <label for="profileUpload" class="edit-icon">
            <i class="fas fa-camera"></i>
        </label>

        <form action="/uploadProfileImage" method="POST" enctype="multipart/form-data">
            <input 
                type="file" 
                id="profileUpload" 
                name="profileImage" 
                style="display:none" 
                onchange="this.form.submit()"
            >
        </form>
    </div>


    <form action="/editProfile" method="POST">

        <div class="mb-3">
            <label>Name</label>
            <input 
                type="text" 
                name="name" 
                class="form-control" 
                value="<%= user ? user.name : '' %>"
            >
        </div>

        <div class="mb-3">
            <label>Email</label>
            <input 
                type="email" 
                name="email" 
                class="form-control" 
                value="<%= user ? user.email : '' %>"
            >
        </div>

        <div class="mb-3">
            <label>Phone</label>
            <input 
                type="text" 
                name="phoneNumber" 
                class="form-control" 
                value="<%= user ? user.phoneNumber : '' %>"
            >
        </div>

        <button class="btn btn-success">Save Changes</button>

        <button 
            class="btn btn-danger ms-2" 
            type="button" 
            onclick="window.location.href='/profile'"
        >
            Cancel
        </button>

    </form>

</div>

<!-- REQUIRED JS -->
<script src="/js/jquery-1.12.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>

</body>
</html>
